<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Interactive Earth globe with grid lines, subsolar/sublunar points, a seasons tour, twilight bands, and an equation-of-time (analemma) microscope inset." />
  <link rel="canonical" href="https://kwakib.netlify.app/index.html" />
  <link rel="alternate" hreflang="en" href="https://kwakib.netlify.app/index.html" />
  <link rel="alternate" hreflang="ar" href="https://kwakib.netlify.app/earth-ar.html" />
  <link rel="alternate" hreflang="x-default" href="https://kwakib.netlify.app/index.html" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Earth Sun/Moon Subpoints &amp; Twilight Viewer" />
  <meta property="og:description" content="Interactive Earth globe with grid lines, subsolar/sublunar points, a seasons tour, twilight bands, and an equation-of-time (analemma) microscope inset." />
  <meta property="og:image" content="https://kwakib.netlify.app/2k_earth_daymap.jpg" />
  <meta property="og:url" content="https://kwakib.netlify.app/index.html" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="Earth Sun/Moon Viewer" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Earth Sun/Moon Subpoints &amp; Twilight Viewer" />
  <meta name="twitter:description" content="Explore daylight, twilight, seasons, and the equation-of-time analemma with an interactive 3D Earth microscope inset." />
  <meta name="twitter:image" content="https://kwakib.netlify.app/2k_earth_daymap.jpg" />
  <title>Earth Sun/Moon Subpoints & Twilight Viewer</title>
  <script>window.FORCED_LANG='en';</script>
  <script type="application/ld+json">

    {

      "@context": "https://schema.org",

      "@type": "BreadcrumbList",

      "itemListElement": [

        {

          "@type": "ListItem",

          "position": 1,

          "name": "Home",

          "item": "https://kwakib.netlify.app/"

        },

        {

          "@type": "ListItem",

          "position": 2,

          "name": "Earth Sun/Moon Viewer",

          "item": "https://kwakib.netlify.app/index.html"

        }

      ]

    }

  </script>
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "url": "https://kwakib.netlify.app/index.html",
      "name": "Earth Sun/Moon Subpoints & Twilight Viewer",
      "inLanguage": "en",
      "description": "Interactive Earth globe with grid lines, subsolar/sublunar points, a seasons tour, twilight bands, and an equation-of-time (analemma) microscope inset.",
      "isPartOf": {
        "@type": "WebSite",
        "url": "https://kwakib.netlify.app/",
        "name": "Qibla Earth Simulator"
      }
    }
  </script>
  <link rel="stylesheet" href="viewerBase.css" />
  <link rel="stylesheet" href="earthViewer.css" />
<script id="earthCopy" type="application/json">
  {
    "metricsRouteLabel": "A-B",
    "metricsDistanceLabel": "Distance ({route})",
    "metricsHeadingLabel": "Initial heading ({route})",
    "durationsPrompt": "Select a point to see day/night duration.",
    "pointLabelSingle": "Point",
    "pointLabelA": "Point A",
    "pointLabelB": "Point B",
    "labelDay": "Day",
    "labelNight": "Night",
    "labelMoonUp": "Moon up",
    "durationsSummary": "At your point: Day {day}, Night {night}",
    "hoverLabel": "Hover: lat {lat}, lon {lon}",
    "noonUnchanged": "unchanged",
    "noonEarlier": "{value} earlier",
    "noonLater": "{value} later",
    "analemmaCumulativeLabel": "Cumulative: {value}",
    "analemmaDailyDifference": "Daily difference: {value}",
    "eotShortLabel": "EoT",
    "analemmaEotValue": "{label} = {value}",
    "analemmaInspectorEcc": "Ecc {value}",
    "analemmaInspectorObliq": "Compression factor {value}",
    "analemmaInspectorCombined": "Daily difference = {mean} - ({mean} {ecc}) * {compression} = {diff} ({diffSeconds})",
    "tooltipDate": "Date: {value}",
    "tooltipExtraAngle": "Extra angle: {value}",
    "tooltipDeltaMean": "Delta vs mean: {value}",
    "tooltipTiltFactor": "Tilt factor: {value}",
    "eotChartTitle": "Equation of time",
    "chartMinutesUnit": "min",
    "chartTodayLabel": "Today",
    "insetDeltaLon": "Δlon {value}",
    "insetDeltaLat": "Δlat {value}",
    "insetRealSunLabel": "Real Sun λ",
    "timeAgo": "{value} ago",
    "timeIn": "in {value}",
    "eotHintEarlier": "apparent noon earlier",
    "eotHintLater": "apparent noon later",
    "eotHintMatches": "apparent noon matches",
    "eotSummary": "Equation of time: {value} ({hint})",
    "meridianRealLeads": "real Sun leads",
    "meridianMeanLeads": "mean Sun leads",
    "meridianAligned": "aligned",
    "meridianSummary": "Meridian: mean Sun {mean}, real Sun {real} (real - mean {delta}, {hint})",
    "meridianSummarySolarDay": "Meridian: mean Sun {mean}, real Sun {real} (real - mean {delta}, {hint}). Solar day ≈ {sidereal} + {extra} = {apparent} ({delta24} vs 24:00:00)",
    "seasonsInsetDaylight": "Daylight: {hours}",
    "seasonsInsetTwilightAngle": "Twilight duration (-{angle} deg): {hours}",
    "seasonsInsetTwilight": "Twilight duration: {hours}",
    "seasonsInsetLatYear": "Lat {lat} deg, {year}",
    "seasonsInsetHeading": "Today at this latitude",
    "seasonsInsetDayLabel": "Day",
    "seasonsInsetNightLabel": "Night",
    "seasonsInsetLocalSolarTime": "Local solar time: {hhmm}",
    "subsolarRealLabel": "Subsolar (real)",
    "subsolarMeanLabel": "Subsolar (mean)",
    "sublunarLabel": "Sublunar",
    "coordLatLabel": "lat",
    "coordLonLabel": "lon",
    "coordDegLabel": "deg",
    "tourStepProgress": "Step {current} / {total}",
    "tourPoiLocked": "POI locked: lat {lat}, lon {lon}",
    "tourPoiPrompt": "Pick a point to continue.",
    "tourPoiInvalid": "Enter a valid lat/lon first.",
    "tourPoiFirst": "Pick a point first.",
    "tour_seasons_title": "Day/night through the seasons",
    "tour_seasons_step0_title": "Pick a place",
    "tour_seasons_step0_body": "Click the globe (or enter lat/lon and press \"Use typed point\"). We will track how daylight changes here.",
    "tour_seasons_step1_title": "March equinox",
    "tour_seasons_step1_body": "Day and night are roughly equal everywhere. Your point should see ~12h daylight.",
    "tour_seasons_step2_title": "June solstice",
    "tour_seasons_step2_body": "Northern points enjoy longer days; southern points get shorter ones.",
    "tour_seasons_step3_title": "September equinox",
    "tour_seasons_step3_body": "Day and night balance again as the subsolar point crosses the equator.",
    "tour_seasons_step4_title": "December solstice",
    "tour_seasons_step4_body": "Southern summer / northern winter. Daylight flips from June.",
    "tour_analemma_title": "Analemma (equation of time)",
    "tour_analemma_step0_title": "Choose a point",
    "tour_analemma_step0_body": "Pick a site; we will compare the mean (reference) Sun with the apparent Sun at your meridian.",
    "tour_analemma_step1_title": "Baseline: mean noon",
    "tour_analemma_step1_body": "Start near the day when equation of time is ~0. At local noon the mean and real Sun align over your longitude. Inset: top compares mean vs real longitude over one sidereal day; bottom shows the real daily motion vector with longitude scaled by cos(dec).",
    "tour_analemma_step2_title": "Eccentricity (speed change)",
    "tour_analemma_step2_body": "Near perihelion in early January Earth moves faster, so the apparent Sun runs ahead of the mean Sun. Solar noon shifts earlier, stretching the analemma east-west.",
    "tour_analemma_step3_title": "Obliquity (tilt projection)",
    "tour_analemma_step3_body": "Around solstice the Sun is far north or south. Its daily motion tilts out of the equatorial plane, so the east-west component is compressed by cos(dec). This adds the vertical loop and another time offset.",
    "tour_analemma_step4_title": "Full-year trace",
    "tour_analemma_step4_body": "Hold mean noon fixed at your longitude and step through a full year. The real subsolar point traces the analemma as eccentricity and tilt combine.",
    "tour_analemma_step5_title": "Explore any date",
    "tour_analemma_step5_body": "Use the date/time input to jump anywhere; the inset and equation-of-time readout update for your longitude."
  }
  </script>
</head>
<body class="earth-main">
  <h1 class="sr-only">Earth Sun/Moon Subpoints & Twilight Viewer</h1>
  <div id="scene"></div>
  <button id="toggleInfoBtn" class="floating-btn">Info</button>
  <button id="toggleControlsBtn" class="floating-btn">Controls</button>
  <div id="langSwitcher">
    <a id="langLinkEn" href="index.html">English</a> |
    <a id="langLinkAr" href="earth-ar.html">العربية</a>
  </div>
  <div class="topic-select" aria-label="Earth topics">
    <label for="topicSelect">Earth topics</label>
        <select id="topicSelect">
      <option value="index.html">Earth overview</option>
      <option value="earth-seasons.html">Seasons tour</option>
      <option value="earth-analemma.html">Analemma tour</option>
      <option value="planets.html">Planets</option>
      <option value="venus.html">Venus visibility</option>
    </select>
  </div>
  <script type="module" src="topicSelect.js"></script>
  <div id="leftPanels">
    <div id="infoPanel">
      <h2 id="infoTitle">Earth Simulator</h2>
      <p id="infoIntro">An interactive globe with subsolar/sublunar points, time controls, and great-circle measurements between two locations.</p>
      <ul>
        <li id="infoLi1">Plot two custom lat/lon points with highlight rings.</li>
        <li id="infoLi2">Trace the great-circle route between points with distance and initial heading.</li>
        <li id="infoLi3">Inspect subsolar and sublunar points with day/night overlays.</li>
        <li id="infoLi4">Scrub date/time or jump by sidereal days to animate footprints.</li>
        <li id="infoLi5">Toggle night/Moon overlays and view numeric subpoint readouts.</li>
        <li id="infoLi6">Use sun-sync or terminator camera modes to follow the daylight edge.</li>
        <li id="infoLi7">Show twilight bands with a configurable sun-below-horizon angle.</li>
      </ul>
      <div class="faq-block">
        <h4 id="faqHeading">FAQ</h4>
        <div class="qa">
          <strong id="faqQ1">How do I compare two locations?</strong>
          <span id="faqA1">Enter Point A/B or click the globe; the great-circle path shows distance and initial heading.</span>
        </div>
        <div class="qa">
          <strong id="faqQ2">How do I keep the view aligned with daylight?</strong>
          <span id="faqA2">Use Sun-sync, Dawn, or Dusk camera modes to follow the subsolar point or terminator line.</span>
        </div>
        <div class="qa">
          <strong id="faqQ3">Can I toggle overlays?</strong>
          <span id="faqA3">Use Twilight Band to set the horizon offset and the Night visibility checkbox to enable/disable the night overlay.</span>
        </div>
      </div>
    </div>
    <div id="datesPanel">
      <h3 id="interestingDatesHeading">Interesting dates</h3>
      <div id="interestingDates">
        <details class="date-group">
          <summary>99% of population see sunlight</summary>
          <div class="date-desc">Add a short description here.</div>
          <div class="date-list">
            <button type="button" class="date-jump" data-datetime="2025-07-08T11:00">Jul 08 11:00 UTC</button>
            <button type="button" class="date-jump" data-datetime="2025-06-04T11:00">Jun 04 11:00 UTC</button>
          </div>
        </details>
        <details class="date-group">
          <summary>Sun over Makkah (solar zenith)</summary>
          <div class="date-desc">Local time in Makkah (UTC+3). Buttons jump to UTC.</div>
          <div class="date-list">
            <button type="button" class="date-jump" data-datetime="2025-05-27T09:18">May 27 09:18 UTC (12:18 local)</button>
            <button type="button" class="date-jump" data-datetime="2025-07-15T09:19">Jul 15 09:19 UTC (12:19 local)</button>
          </div>
        </details>
      </div>
    </div>
  </div>
  <div id="sidePanels">
    <div id="controls">
    <div class="section" title="Set UTC time; sidereal day steps shift subsolar longitude eastward (~360 deg / 23h56m).">
      <h3 id="timeAnimHeading">Time & Animation</h3>
      <label id="datetimeLabel">Date/Time (UTC)</label>
      <div class="row">
        <input id="datetime" type="text" style="flex:1; min-width: 0;" placeholder="YYYY-MM-DDTHH:MM" title="Format: YYYY-MM-DDTHH:MM" />
        <button id="resetNowBtn" title="Set to current UTC time">Now</button>
      </div>
      <div class="row" style="margin-top:6px;">
        <button id="siderealMinusBtn" title="Jump back 1 sidereal day (23h56m)">-1 sidereal day</button>
        <button id="siderealPlusBtn" title="Jump forward 1 sidereal day (23h56m)">+1 sidereal day</button>
      </div>
      <div class="row" style="margin-top:6px;">
        <button class="timeStep" data-unit="day" data-delta="-1">-1 day</button>
        <button class="timeStep" data-unit="day" data-delta="1">+1 day</button>
        <button class="timeStep" data-unit="hour" data-delta="-1">-1 hr</button>
        <button class="timeStep" data-unit="hour" data-delta="1">+1 hr</button>
        <button class="timeStep" data-unit="minute" data-delta="-10">-10 min</button>
        <button class="timeStep" data-unit="minute" data-delta="10">+10 min</button>
      </div>
    </div>

    <div class="section">
      <h3 id="sunMoonHeading">Sun & Moon</h3>
      <label id="sunVisLabel"><input id="toggleSunVisibility" type="checkbox" checked /> <span id="sunVisText">Night visibility</span></label>
      <label id="moonVisLabel"><input id="toggleMoonVisibility" type="checkbox" checked /> <span id="moonVisText">Moon visibility</span></label>
    </div>

    <div class="section">
      <h3 id="cameraHeading">Camera</h3>
      <div class="segment-group" id="cameraSegments">
        <button data-mode="geo" class="active">Geosync</button>
        <button data-mode="sun">Sun-sync</button>
        <button data-mode="dawn">Dawn</button>
        <button data-mode="dusk">Dusk</button>
      </div>
    </div>

    <div class="section">
      <h3 id="twilightHeading">Twilight Band</h3>
      <label class="row inputs-inline" style="margin-top:2px; align-items:flex-start; gap:10px;">
        <span id="twilightLimitLabel" style="min-width:130px;">Twilight limit (deg below horizon):</span>
        <div style="display:flex; flex-direction:column; gap:4px; width:100%;">
          <input id="twilightAngle" type="range" min="0" max="18" step="0.5" value="18" />
          <span id="twilightValue" style="font-size:12px; color:#cfdcff;">18 deg</span>
        </div>
      </label>
    </div>

    <div class="section">
      <h3 id="pointsHeading">Points</h3>
      <label id="pointALabel">Point A (lat, lon) <span style="color:#ff6699;">&bull;</span></label>
      <div class="row inputs-inline">
        <input id="lat1" type="number" step="0.1" />
        <input id="lon1" type="number" step="0.1" />
      </div>
      <label id="pointBLabel">Point B (lat, lon) <span style="color:#66ff99;">&bull;</span></label>
      <div class="row inputs-inline">
        <input id="lat2" type="number" step="0.1" />
        <input id="lon2" type="number" step="0.1" />
      </div>
      <div class="row" style="margin-top:6px;">
        <button id="plotBtn">Plot points</button>
        <button id="clearPointsBtn" style="background:#444a5a;">Clear</button>
      </div>
    </div>

  </div>
  <div id="dataPanel">
    <h3 id="dataHeading">Sun & Moon Data</h3>
    <div id="subpoints" style="font-size:12px; line-height:1.4;"></div>
    <div id="durations" style="font-size:12px; line-height:1.4; margin-top:6px; color:#cfdcff;"></div>
    <div id="pointMetrics" style="font-size:12px; line-height:1.4; margin-top:6px; color:#cfdcff;"></div>
    <div id="hoverBox" style="font-size:12px; line-height:1.4; margin-top:6px; color:#cfdcff;">
      <div id="hoverLabel"></div>
    </div>
  </div>
  </div>
  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.module.js",
        "three/examples/jsm/": "https://cdn.jsdelivr.net/npm/three@0.155.0/examples/jsm/"
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/astronomy-engine@2.1.19/astronomy.browser.js"></script>

  <script type="module" src="earthViewer.js"></script>
  <footer>
    Texture map credit: <a href="https://www.solarsystemscope.com/textures/" target="_blank" rel="noopener">Solar System Scope</a>
    <div style="margin-top:4px;">Questions/feedback: <a href="mailto:qibla-site@proton.me">qibla-site@proton.me</a></div>
  </footer>
</body>
</html>





